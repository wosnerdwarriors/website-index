<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta property="og:title" content="Alliance Layout Planner">
    <meta property="og:description" content="Check out this Layout!">
    <meta property="og:url" content="https://wosnerds.com/layout-planner/index.html">
    <link rel="stylesheet" href="/dist/css/tailwind.css?v=2">
    <link rel="stylesheet" href="/layout-planner/css/style.css">
    <title>Alliance Layout Planner</title>
</head>

<body>
    <!-- Fullscreen Canvas -->
    <canvas id="layoutCanvas"></canvas>
    
    <!-- Top Toolbar Panel -->
    <div id="toolbarPanel" class="floating-panel">
        <button class="panel-toggle" onclick="togglePanel('toolbarPanel')">▼</button>
        <h2 class="text-lg font-bold mb-3 text-center"></h2>
        
        <div class="flex flex-col items-center mb-3">
            <input id="mapNameInput" type="text" placeholder="Map Name (optional)" class="border p-2 rounded text-center" style="width: 30ch;" maxlength="30">
            <div id="mapNameHint" class="text-center text-red-500 text-sm mt-1" style="display: none;"></div>
        </div>
        
        <div id="toolbar" class="mb-3">
            <!-- Control buttons row -->
            <div class="flex flex-wrap gap-2 mb-2">
                <button data-type="select" class="bg-gray-500 hover:bg-gray-600 text-white px-3 py-2 rounded text-sm">Select</button>
                <button id="deleteButton" class="bg-red-500 hover:bg-red-600 text-white px-3 py-2 rounded text-sm">Delete</button>
            </div>
            <!-- Object buttons row -->
            <div class="flex flex-wrap gap-2">
                <button data-type="flag" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded text-sm">Flag (1x1)</button>
                <button data-type="city" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded text-sm">City (2x2)</button>
                <button data-type="building" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded text-sm">Bear Trap (3x3)</button>
                <button data-type="node" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded text-sm">Node (3x3)</button>
                <button data-type="obstacle" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded text-sm">Obstacle (1x1)</button>
            </div>
        </div>
        
        <div id="counters" class="text-sm p-2 bg-gray-100 rounded text-center">
            <span class="mr-3">Flags: <span id="flagCounter" class="font-bold">0</span></span>
            <span class="mr-3">Cities: <span id="cityCounter" class="font-bold">0</span></span>
            <span class="mr-3">Bear Traps: <span id="buildingCounter" class="font-bold">0</span></span>
            <span>Nodes: <span id="nodeCounter" class="font-bold">0</span></span>
        </div>
    </div>
    
    <!-- Right Actions Panel -->
    <div id="actionsPanel" class="floating-panel">
        <button class="panel-toggle" onclick="togglePanel('actionsPanel')">▼</button>
        <h2 class="text-lg font-bold mb-3 text-center">Actions</h2>
        
        <div class="space-y-2">
            <button id="downloadButton" class="bg-green-500 hover:bg-green-600 text-white px-3 py-2 rounded w-full text-sm">Save as PNG</button>
            <button id="saveButton" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded w-full text-sm">Generate Code</button>
            <button id="shareButton" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded w-full text-sm">Copy Link</button>
            <button id="shortUrlButton" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded w-full text-sm">Generate Short URL</button>
            <textarea id="mapData" rows="3" placeholder="Map code..." class="w-full p-2 border border-gray-300 rounded text-xs"></textarea>
            <button id="loadButton" class="bg-yellow-500 hover:bg-yellow-600 text-white px-3 py-2 rounded w-full text-sm">Load</button>
            <div id="shortUrlContainer" class="mt-2 hidden">
                <input id="shortUrlOutput" type="text" readonly class="w-full p-2 border border-gray-300 rounded text-xs mb-1" />
                <button id="copyShortUrlButton" class="bg-green-500 hover:bg-green-600 text-white px-2 py-1 rounded text-xs">Copy</button>
                <span id="shortUrlError" class="text-red-500 text-xs ml-2"></span>
                <div id="discordExportContainer" class="mt-2 hidden">
                    <label for="discordExportOutput" class="block text-xs font-medium mb-1">Discord Export</label>
                    <input id="discordExportOutput" type="text" readonly class="w-full p-2 border border-blue-300 rounded text-xs mb-1" />
                    <button id="copyDiscordExportButton" class="bg-blue-500 hover:bg-blue-600 text-white px-2 py-1 rounded text-xs">Copy Discord Export</button>
                </div>
            </div>
        </div>
        
        <div id="info" class="mt-3">
            <span id="copyMessage" class="hidden text-green-500 font-medium text-xs">Copied!</span>
        </div>
    </div>

    <!-- Bottom Cities Panel -->
    <div id="citiesPanel" class="floating-panel">
        <button class="panel-toggle" onclick="togglePanel('citiesPanel')" style="top: -12px; bottom: auto;">▼</button>
        <h2 class="text-lg font-bold mb-3 text-center">Cities List</h2>
        <div class="mb-2">
            <label for="citySort" class="text-sm">Sort by:</label>
            <select id="citySort" class="text-sm border rounded p-1"></select>
        </div>
        <ul id="cityList" class="space-y-1"></ul>
    </div>

    <!-- Controls Panel -->
    <div id="helpPanel" class="floating-panel">
        <button class="panel-toggle" onclick="togglePanel('helpPanel')" style="top: -12px; bottom: auto;">▼</button>
        <h2 class="text-lg font-bold mb-3 text-center">Controls</h2>
        <div class="text-xs space-y-2">
            <div>
                <p class="font-semibold text-blue-600 mb-1">Placing Objects</p>
                <p class="ml-2">• Select an object type from toolbar</p>
                <p class="ml-2">• Click on grid to place</p>
            </div>
            <div>
                <p class="font-semibold text-green-600 mb-1">Selection & Movement</p>
                <p class="ml-2">• Choose "Select" → click object</p>
                <p class="ml-2">• Drag or use arrow keys to move</p>
                <p class="ml-2">• Type to rename cities</p>
            </div>
            <div>
                <p class="font-semibold text-red-600 mb-1">Deletion</p>
                <p class="ml-2">• Choose "Select" → click object</p>
                <p class="ml-2">• Delete key or Delete button</p>
            </div>
            <div>
                <p class="font-semibold text-purple-600 mb-1">Navigation</p>
                <p class="ml-2">• Mouse wheel: Zoom in/out</p>
                <p class="ml-2">• Middle mouse: Pan around map</p>
            </div>
        </div>
    </div>

    <div class="credit-bubble">
        <div class="text-xs text-white text-center">
            Original author: 
            <a href="https://github.com/GFXSpeed" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:text-blue-800 font-medium underline">
                GFXSpeed
            </a>
        </div>
    </div>

    <script src="/layout-planner/js/script.js"></script>
    <script src="/js/navbar.js"></script>
    
    <script>
        function togglePanel(panelId) {
            const panel = document.getElementById(panelId);
            panel.classList.toggle('panel-collapsed');
        }
        
        // Initialize panels as visible
        document.addEventListener('DOMContentLoaded', function() {
            // Panels start visible, no action needed
        });
    </script>
</body>
</html>
